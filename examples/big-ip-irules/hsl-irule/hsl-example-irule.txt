when RULE_INIT {
  set static::Debug true
}

when CLIENT_ACCEPTED {
  set hsl [HSL::open -publisher /Common/HSL_publisher]
  if { $static::Debug } {
    HSL::send $hsl "Access from client [clientside {IP::remote_addr}]"
  }
}

when HTTP_REQUEST {
  if { $static::Debug } {
    HSL::send $hsl "Http request .... [HTTP::method] [HTTP::path] [HTTP::version]"
  }
}

when LB_SELECTED {
  if { $static::Debug } {
    HSL::send $hsl "LB selected"
  }
}

when SERVER_CONNECTED {
  if { $static::Debug } {
    HSL::send $hsl "Pool member selected: [serverside {IP::remote_addr}]"
  }
}

when HTTP_RESPONSE {
  if { $static::Debug } {
    HSL::send $hsl "Response [HTTP::status] sent [serverside { IP::remote_addr }] -> [clientside {IP::remote_addr}]"
  }
}

when SERVER_CLOSED {
  if { $static::Debug } {
    HSL::send $hsl "Server closed connection from client: [serverside {IP::remote_addr}]"
  }
}

when CLIENT_CLOSED {
  if { $static::Debug } {
    HSL::send $hsl "Client has closed connection: [clientside { IP::remote_addr }]"
  }
}
